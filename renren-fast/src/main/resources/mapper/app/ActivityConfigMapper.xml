<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="io.renren.modules.app.dao.ActivityConfigDao">

    <resultMap id="ConfigDetailVo" type="io.renren.modules.app.vo.ConfigDetailVo">
        <result column = "config_id" property="configId"/>
        <result column = "config_name" property="configName"/>
        <result column = "win_prize" property="winPrize"/>
        <result column = "win_prize_number" property="winPrizeNumber"/>
        <result column = "batch_get" property="batchGet"/>
        <result column = "batch_get_number" property="batchGetNumber"/>
        <collection property="prizeList" ofType="io.renren.modules.app.vo.ConfigPrizeVo">
            <id column = "prize_id" property="prizeId"/>
            <result column = "prize_name" property="prizeName"/>
            <result column = "prize_number" property="prizeNumber"/>
            <result column = "prize_probability_fixed" property="prizeProbabilityFixed"/>
            <result column = "prize_probability" property="prizeProbability"/>
            <result column = "prize_total_limit" property="prizeTotalLimit"/>
            <result column = "prize_total" property="prizeTotal"/>
        </collection>
    </resultMap>

    <select id="getConfig" resultMap="ConfigDetailVo">
        select activity_config.*,config_prize.*,prize.*
        from activity
                 inner join activity_config on activity.config_id = activity_config.config_id
                 left join config_prize on activity.config_id = config_prize.config_id
                 left join prize on config_prize.prize_id = prize.prize_id
        where activity.activity_id = #{activityId};
    </select>
</mapper>